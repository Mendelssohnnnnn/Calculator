# Calculator
BUPT: java面向对象课程大作业 用Java写一个计算器

一、软件设计思路
	题目要求是写一个简单的手持计算器，要求设计图形界面，实现基本的运算，错误提示，日志和查看计算结果功能。
	具体思路如下：
1、UI的设计
	我参考了iPhone自带的计算器（如左图）的UI设计，并决定使用与其类似的界面布局，再针对课程设计的要求增加了一些应有的功能。我的UI设计如右图。
   

2、计算器的功能设计
	（1）运算功能
	基本要求是能够实现加减乘除和括号的运算。但是我还不够满意，所以我自己又增加了乘方和三角函数中的sin和cos运算。用户使用鼠标按动UI界面的按钮，后端程序便以字符串的形式接收。其实就相当于一个表达式求值的过程。我运用了数据结构课上学习的知识，实现了表达式求值的算法，并将结构输出至前端的用户界面。另外程序也支持小数运算和连续计算。
	（2）清除功能
	按AC可以全部清零，按Delete可以清除最后一位。非常符合人类的逻辑。
	（3）检错功能
	在用户输入的表达式不合法时（如除数为零），会显示input error。我设计了一个inputException的异常类，在进行表达式求值的过程中若发现输入的表达式不合法，就会弹出错误字样。
	（4）日志功能
	计算器会把每一次成功计算的结果写入到log.txt的文件里。
	（5）查看计算结果功能
	程序会将最近10次的运算结果缓存到buffer中，用户可以点击<--查看历史计算结果。

二、每个类的功能
	1、UI
	功能是设计用户界面，包括界面的布局，按键的设计和文本的显示。
   (1)BuildUI
	构建UI，并连接后端程序。使用JPanel类和Container容器构建。文本框在最上方，下面共6行，每行4列。
	当用户点击按钮，触发ActionEvent，程序判断用户的Action，然后再转到后端进行相应操作。
   (2)Display
	用于确定UI的显示效果。规定文本的字体为Helvetica，按键文本的字号为30，颜色为黑色，背景为白色；文本框为字号为60，颜色为白色，背景为黑色。
	文本框初始值设为0。24个按钮分别为
"AC", "(", ")", "Delete",
"7", "8", "9", "+",
"4", "5", "6", "-",
"1", "2", "3", "*",
"0", ".", "^", "/",
"sin", "cos", "=", "<--"

   2、Calculate
   （1）Calculate
	程序的核心算法：表达式求值。
	构建两个栈，stackOptr和stackOpnd，用于存放操作符和操作数，再根据每种操作符优先级进行压栈和弹栈，最后计算出表达式的值。
   （2）InputException
	输入表达式异常类。如果用户输入了不合法的表达式，如没有意义的表达式或除数为0，那么程序将抛出异常，计算机的文本框将显示“INPUT ERROR！！！”。
   3、Log
	日志类。如果用户不发生输入异常，程序将把运算结果写入到日志中，并记录操作时间。
   4、Main
	主类。用于统筹调用程序。
   5、ResultBuffer
	计算结果缓存类。在每次计算出结果后会把其写入到一个名为buffer的栈中，栈的大小为10，这意味着buffer会保留最近的10条计算结果。如果想查看，按<--即可。按一次会显示上一条计算结果，按两次则会显示上上条计算结果，依此类推。并且这个过程是循环的，也就是说，如果按十一次，显示的又会是最近的一次计算结果。如果buffer已满，但继续进行计算的话，buffer会自动丢弃最早的那一个运算结果，并把最新的一次写入栈中。

三、程序演示视频链接
	本作业并没有要求提交程序，但为了老师能更直观地评估我的程序，我录制了一段视频，并上传到了bilibili。网址如下：
https://www.bilibili.com/video/BV1yL411p77Z/

四、总结
本次大作业过后我收获了很多。首先，我更加了解了Java的语法和面向对象的设计方法，其次，我也充分联系了图形化的运用。我在程序设计中没有遇到特别大的困难。碰到最典型的bug是double类型精度不够导致误差，最后通过查阅资料，使用了BigDecimal，成功解决了问题。
我收获比较大的一点是能及时提炼有用的信息作为书写程序的辅助理解和程序输出结果的校对；同时，在这个过程中我更是感受到了Java的乐趣。在这种比较复杂，模块比较多的工程中，一个具体实际的设计，是至关重要的。因为如果不把接口和模块之间的衔接做好，在后期各个模块拼接时往往会出现各种各样的问题，调整起来也十分复杂，正如俗话说的“磨刀不误砍柴工”，一个好的全局设计会给后期节省不少的精力和时间。总之，我受益匪浅。
